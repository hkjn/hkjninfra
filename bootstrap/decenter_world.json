{"ignition":{"version":"2.0.0","config":{}},"storage":{"filesystem":[],"files":[{"filesystem":"root","path":"/etc/coreos/update.conf","contents":{"source":"data:,GROUP%3Dbeta%0AREBOOT_STRATEGY%3D%22etcd-lock%22","verification":{}},"mode":420,"user":{},"group":{}},{"filesystem":"root","path":"/opt/bin/gather_facts","contents":{"source":"https://github.com/hkjn/hkjninfra/releases/download/1.5.0/gather_facts","verification":{"hash":"sha512-ff7bdbfb8fe387144529e658d04bcf78e8d4f10f36b82b78892be845b4c40b68112c35f36ea05df3d79969319dba29b2caed123f29245038ad0efa68b4a5de4d"}},"mode":493,"user":{},"group":{}},{"filesystem":"root","path":"/opt/bin/tclient","contents":{"source":"https://github.com/hkjn/hkjninfra/releases/download/1.5.0/tclient_x86_64","verification":{"hash":"sha512-383cbda29f3355e5496baad8093e05045b95aea8da3d96d7bef4c823b3f06b9f59347184dd30dea21d553c03352d774be450436e4d0d9fe054ec02b996e83636"}},"mode":493,"user":{},"group":{}},{"filesystem":"root","path":"/etc/ssl/mon_ca.pem","contents":{"source":"https://admin1.hkjn.me/151fb337c9b9a51b7027f10b8b20b46ea12dd4edb2427c57b19877075d227c039dad00db4049928501ec3963ded8e086b96ee9436e6d68b9c7524c68bc34d0bc/files/certs/mon_ca.pem","verification":{"hash":"sha512-cf8032384a17fc591f83030a3a536f8b80e79c7d6e5e839e5003b587163bf371a51ab1b14dc047486cfd55fb74238d69253fcb27d49245ba249359584b169bb4"}},"mode":493,"user":{},"group":{}},{"filesystem":"root","path":"/opt/bin/decenter_world","contents":{"source":"https://github.com/hkjn/decenter.world/releases/download/1.1.7/decenter_world_x86_64","verification":{"hash":"sha512-123cec939d7c03c239ee6040185ccb8b74d5d875764479444448ca2ea31d25f364a891363a5850fba2564ce238c7548b3677d713ce69ed7caf421950cd3cd5c6"}},"mode":493,"user":{},"group":{}},{"filesystem":"root","path":"/opt/bin/decenter_redirector","contents":{"source":"https://github.com/hkjn/decenter.world/releases/download/1.1.7/decenter_redirector_x86_64","verification":{"hash":"sha512-624a743e008e9a02bd46ec3d6d0bdffd57749695a336e59ebc53875a8867d39990d38ed7638e9f3d2255345626ca3ed16fe9e2235dacaf28646c250d1d5d0a21"}},"mode":493,"user":{},"group":{}},{"filesystem":"root","path":"/etc/ssl/client.pem","contents":{"source":"https://admin1.hkjn.me/151fb337c9b9a51b7027f10b8b20b46ea12dd4edb2427c57b19877075d227c039dad00db4049928501ec3963ded8e086b96ee9436e6d68b9c7524c68bc34d0bc/files/certs/decenter.world.pem","verification":{"hash":"sha512-e9c89e72d89d93fb7015c63413927913cbfca8eb5cd50523b105d0c37a89bf8ab8965a4b489c5ec54d64e9afb4a480aacac52b47be03d1044ad1d4ca9cd2844d"}},"mode":493,"user":{},"group":{}},{"filesystem":"root","path":"/etc/ssl/client-key.pem","contents":{"source":"https://admin1.hkjn.me/151fb337c9b9a51b7027f10b8b20b46ea12dd4edb2427c57b19877075d227c039dad00db4049928501ec3963ded8e086b96ee9436e6d68b9c7524c68bc34d0bc/files/certs/decenter.world-key.pem","verification":{"hash":"sha512-e01f327e1089d652a521ddc402171dcdaeaf70f8f59b916a426efabe9a8e5ae78d3842cbb7e0caa11630b33b6b1ceb7e1f8871bedfde0f312a9b577697269d6b"}},"mode":493,"user":{},"group":{}}]},"systemd":{"units":[{"enable":true,"name":"decenter.service","contents":"[Unit]\nDescription=decenter.world server\nAfter=network-online.target\n\n[Service]\nEnvironment=PATH=/usr/bin/:/opt/bin:/bin\nEnvironment=DECENTER_WORLD_ADDR=:443\nExecStart=/usr/bin/bash -c \"decenter_world\"\nRestart=always\n\n[Install]\nWantedBy=multi-user.target\n \n"},{"enable":true,"name":"decenter_redirector.service","contents":"[Unit]\nDescription=decenter.world redirector server\n\nAfter=network-online.target\n\n[Service]\nEnvironment=PATH=/usr/bin/:/opt/bin:/bin\nExecStart=/usr/bin/bash -c \"decenter_redirector\"\nRestart=always\n\n[Install]\nWantedBy=multi-user.target\n"},{"enable":true,"name":"etc-secrets.mount","contents":"[Mount]\nWhat=/dev/disk/by-id/scsi-0Google_PersistentDisk_persistent-disk-1\nWhere=/etc/secrets\nType=ext4\n\n[Install]\nRequiredBy=local-fs.target\n"},{"enable":true,"name":"tclient.service","contents":"[Unit]\nDescription=tclient\nAfter=network-online.target\n\n[Service]\nEnvironment=REPORT_ADDR=mon.hkjn.me:50051\nEnvironment=REPORT_FACTS_PATH=/etc/report_facts.json\nEnvironment=REPORT_TLS_CA_CERT=/etc/ssl/mon_ca.pem\nEnvironment=REPORT_TLS_CERT=/etc/ssl/client.pem\nEnvironment=REPORT_TLS_KEY=/etc/ssl/client-key.pem\n\nExecStartPre=-/bin/bash -c \"/opt/bin/gather_facts \u003e /etc/report_facts.json\"\nExecStart=/opt/bin/tclient\n\n[Install]\nWantedBy=multi-user.target\n"},{"enable":true,"name":"tclient.timer","contents":"[Unit]\nDescription=Timer that starts report_client.service\n\n[Timer]\n# Run every 5 min.\nOnCalendar=*:0/5\nPersistent=true\n\n[Install]\nWantedBy=multi-user.target\n"}],"passwd":{},"networkd":{}}}
